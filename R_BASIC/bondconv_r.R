#
#?????????? ??????????
#convexity

# ???????????? ????????? r - ???? ????????
bondconv_r <- function(p, cr, ttm, r) {
  cf <- c(rep(p * cr, times=ttm - 1), p * (1 + cr))
  cf <- data.frame(cf)
  cf$t <- as.numeric(rownames(cf))
  cf$pv_factor <- exp(-r*cf$t)
  cf$pv <- cf$cf * cf$pv_factor*cf$t^2
  sum(cf$pv)/bondprc_r(p, cr, ttm, r)
}

i=0.1
r1<-log(1+i)
c1<-bondconv_r(100, 0.1, 5, r=r1)
c1
